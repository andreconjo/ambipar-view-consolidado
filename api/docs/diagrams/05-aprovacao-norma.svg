<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 520">
  <defs>
    <linearGradient id="clientGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="ctrlGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#11998e;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#38ef7d;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="svcGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f093fb;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#f5576c;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="dbGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#4facfe;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#00f2fe;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="dbrxGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ee0979;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ff6a00;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="successGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#11998e;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#38ef7d;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.3"/>
    </filter>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#667eea"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="900" height="520" fill="#1a1a2e"/>
  
  <!-- Title -->
  <text x="450" y="30" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="18" font-weight="bold">Fluxo de Aprovação de Norma</text>
  
  <!-- Participants -->
  <rect x="50" y="50" width="90" height="40" rx="8" fill="url(#clientGrad)" filter="url(#shadow)"/>
  <text x="95" y="75" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Cliente</text>
  
  <rect x="195" y="50" width="120" height="40" rx="8" fill="url(#ctrlGrad)" filter="url(#shadow)"/>
  <text x="255" y="75" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9" font-weight="bold">AprovacoesController</text>
  
  <rect x="370" y="50" width="110" height="40" rx="8" fill="url(#svcGrad)" filter="url(#shadow)"/>
  <text x="425" y="75" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9" font-weight="bold">AprovacoesService</text>
  
  <rect x="540" y="50" width="110" height="40" rx="8" fill="url(#dbGrad)" filter="url(#shadow)"/>
  <text x="595" y="75" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9" font-weight="bold">DatabaseService</text>
  
  <rect x="710" y="50" width="90" height="40" rx="8" fill="url(#dbrxGrad)" filter="url(#shadow)"/>
  <text x="755" y="75" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="10" font-weight="bold">Databricks</text>
  
  <!-- Vertical lines (lifelines) - subtle -->
  <line x1="95" y1="100" x2="95" y2="490" stroke="#667eea" stroke-width="1" stroke-dasharray="4,4" opacity="0.3"/>
  <line x1="255" y1="100" x2="255" y2="490" stroke="#38ef7d" stroke-width="1" stroke-dasharray="4,4" opacity="0.3"/>
  <line x1="425" y1="100" x2="425" y2="490" stroke="#f5576c" stroke-width="1" stroke-dasharray="4,4" opacity="0.3"/>
  <line x1="595" y1="100" x2="595" y2="490" stroke="#00f2fe" stroke-width="1" stroke-dasharray="4,4" opacity="0.3"/>
  <line x1="755" y1="100" x2="755" y2="490" stroke="#ff6a00" stroke-width="1" stroke-dasharray="4,4" opacity="0.3"/>
  
  <!-- Step 1: Client to Controller -->
  <path d="M 100 120 L 250 120" stroke="#667eea" stroke-width="2" marker-end="url(#arrow)"/>
  <rect x="115" y="100" width="120" height="32" rx="4" fill="#2d3748"/>
  <text x="175" y="115" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="8">POST /aprovacoes</text>
  <text x="175" y="127" text-anchor="middle" fill="#a0aec0" font-family="Arial, sans-serif" font-size="7">{norma_id, user_id, ...}</text>
  
  <!-- JWT Guard Note -->
  <rect x="195" y="140" width="120" height="25" rx="4" fill="rgba(56,239,125,0.2)" stroke="#38ef7d" stroke-width="1"/>
  <text x="255" y="157" text-anchor="middle" fill="#38ef7d" font-family="Arial, sans-serif" font-size="8">JwtAuthGuard</text>
  
  <!-- Step 2: Controller to Service -->
  <path d="M 260 180 L 420 180" stroke="#38ef7d" stroke-width="2" marker-end="url(#arrow)"/>
  <rect x="290" y="165" width="100" height="22" rx="4" fill="#2d3748"/>
  <text x="340" y="180" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">registrarAprovacao()</text>
  
  <!-- Step 3: Service validates -->
  <rect x="385" y="200" width="80" height="35" rx="4" fill="#4a5568" stroke="#f5576c" stroke-width="1"/>
  <text x="425" y="215" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="8">Validar</text>
  <text x="425" y="227" text-anchor="middle" fill="#a0aec0" font-family="Arial, sans-serif" font-size="7">dados entrada</text>
  
  <!-- Step 4: Service to DB (check existing) -->
  <path d="M 430 250 L 590 250" stroke="#f5576c" stroke-width="2" marker-end="url(#arrow)"/>
  <rect x="460" y="235" width="100" height="22" rx="4" fill="#2d3748"/>
  <text x="510" y="250" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="8">verificarExistente()</text>
  
  <!-- Step 5: DB to Databricks -->
  <path d="M 600 270 L 750 270" stroke="#00f2fe" stroke-width="2" marker-end="url(#arrow)"/>
  <rect x="620" y="255" width="100" height="22" rx="4" fill="#2d3748"/>
  <text x="670" y="270" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="7">SELECT * WHERE id=</text>
  
  <!-- Step 6: Databricks returns -->
  <path d="M 750 295 L 600 295" stroke="#ff6a00" stroke-width="2" marker-end="url(#arrow)"/>
  <rect x="640" y="280" width="70" height="22" rx="4" fill="#2d3748"/>
  <text x="675" y="295" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">exists?</text>
  
  <!-- Step 7: DB returns to Service -->
  <path d="M 590 315 L 430 315" stroke="#00f2fe" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Step 8: Service processes -->
  <rect x="385" y="330" width="80" height="35" rx="4" fill="#4a5568" stroke="#f5576c" stroke-width="1"/>
  <text x="425" y="345" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="8">Preparar</text>
  <text x="425" y="357" text-anchor="middle" fill="#a0aec0" font-family="Arial, sans-serif" font-size="7">INSERT/UPDATE</text>
  
  <!-- Step 9: Service to DB (insert) -->
  <path d="M 430 380 L 590 380" stroke="#f5576c" stroke-width="2" marker-end="url(#arrow)"/>
  <rect x="460" y="365" width="100" height="22" rx="4" fill="#2d3748"/>
  <text x="510" y="380" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="8">insertAprovacao()</text>
  
  <!-- Step 10: DB to Databricks (insert) -->
  <path d="M 600 400 L 750 400" stroke="#00f2fe" stroke-width="2" marker-end="url(#arrow)"/>
  <rect x="625" y="385" width="90" height="22" rx="4" fill="#2d3748"/>
  <text x="670" y="400" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="7">INSERT INTO...</text>
  
  <!-- Step 11: Databricks confirms -->
  <path d="M 750 420 L 600 420" stroke="#ff6a00" stroke-width="2" marker-end="url(#arrow)"/>
  <rect x="640" y="405" width="70" height="22" rx="4" fill="#2d3748"/>
  <text x="675" y="420" text-anchor="middle" fill="#38ef7d" font-family="Arial, sans-serif" font-size="9">✓ OK</text>
  
  <!-- Step 12: DB returns to Service -->
  <path d="M 590 440 L 430 440" stroke="#00f2fe" stroke-width="2" marker-end="url(#arrow)"/>
  <rect x="475" y="425" width="80" height="22" rx="4" fill="#2d3748"/>
  <text x="515" y="440" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">success</text>
  
  <!-- Step 13: Service to Controller -->
  <path d="M 420 460 L 260 460" stroke="#f5576c" stroke-width="2" marker-end="url(#arrow)"/>
  <rect x="290" y="445" width="100" height="22" rx="4" fill="#2d3748"/>
  <text x="340" y="460" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">{aprovacao}</text>
  
  <!-- Step 14: Controller to Client -->
  <path d="M 250 485" L 100 485" stroke="url(#ctrlGrad)" stroke-width="2" marker-end="url(#arrow)"/>
  <rect x="130" y="470" width="90" height="22" rx="4" fill="rgba(56,239,125,0.2)" stroke="#38ef7d" stroke-width="1"/>
  <text x="175" y="485" text-anchor="middle" fill="#38ef7d" font-family="Arial, sans-serif" font-size="9" font-weight="bold">201 Created</text>
</svg>