<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 450">
  <defs>
    <linearGradient id="clientGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="guardGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f093fb;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#f5576c;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="strategyGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#fa709a;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#fee140;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="dbGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#4facfe;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#00f2fe;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.3"/>
    </filter>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#667eea"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="800" height="450" fill="#1a1a2e"/>
  
  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="18" font-weight="bold">Validação de Token JWT</text>
  
  <!-- Participants -->
  <rect x="50" y="50" width="100" height="40" rx="8" fill="url(#clientGrad)" filter="url(#shadow)"/>
  <text x="100" y="75" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Cliente</text>
  
  <rect x="230" y="50" width="100" height="40" rx="8" fill="url(#guardGrad)" filter="url(#shadow)"/>
  <text x="280" y="75" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="11" font-weight="bold">JwtAuthGuard</text>
  
  <rect x="410" y="50" width="100" height="40" rx="8" fill="url(#strategyGrad)" filter="url(#shadow)"/>
  <text x="460" y="75" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="11" font-weight="bold">JwtStrategy</text>
  
  <rect x="590" y="50" width="100" height="40" rx="8" fill="url(#dbGrad)" filter="url(#shadow)"/>
  <text x="640" y="75" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Database</text>
  
  <!-- Vertical lines (lifelines) -->
  <line x1="100" y1="95" x2="100" y2="420" stroke="#667eea" stroke-width="1" stroke-dasharray="4,4" opacity="0.3"/>
  <line x1="280" y1="95" x2="280" y2="420" stroke="#f5576c" stroke-width="1" stroke-dasharray="4,4" opacity="0.3"/>
  <line x1="460" y1="95" x2="460" y2="420" stroke="#fee140" stroke-width="1" stroke-dasharray="4,4" opacity="0.3"/>
  <line x1="640" y1="95" x2="640" y2="420" stroke="#00f2fe" stroke-width="1" stroke-dasharray="4,4" opacity="0.3"/>
  
  <!-- Step 1: Client sends request with Bearer Token -->
  <path d="M 105 120 L 275 120" stroke="#667eea" stroke-width="2" marker-end="url(#arrow)"/>
  <rect x="130" y="100" width="120" height="30" rx="4" fill="#2d3748"/>
  <text x="190" y="115" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">Request +</text>
  <text x="190" y="127" text-anchor="middle" fill="#a0aec0" font-family="Arial, sans-serif" font-size="8">Bearer Token</text>
  
  <!-- Step 2: Guard to Strategy -->
  <path d="M 285 155 L 455 155" stroke="#f5576c" stroke-width="2" marker-end="url(#arrow)"/>
  <rect x="320" y="140" width="100" height="22" rx="4" fill="#2d3748"/>
  <text x="370" y="155" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">Extrair JWT</text>
  
  <!-- Step 3: Strategy validates -->
  <rect x="420" y="175" width="80" height="50" rx="6" fill="#4a5568" stroke="#fee140" stroke-width="1"/>
  <text x="460" y="193" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="8">Validar:</text>
  <text x="460" y="206" text-anchor="middle" fill="#a0aec0" font-family="Arial, sans-serif" font-size="7">• Assinatura</text>
  <text x="460" y="218" text-anchor="middle" fill="#a0aec0" font-family="Arial, sans-serif" font-size="7">• Expiração</text>
  
  <!-- Decision: Token valid? -->
  <polygon points="460,245 490,270 460,295 430,270" fill="#2d3748" stroke="#fee140" stroke-width="2"/>
  <text x="460" y="273" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="8">OK?</text>
  
  <!-- Token Invalid path -->
  <path d="M 430 270 L 285 270" stroke="#ee0979" stroke-width="2" marker-end="url(#arrow)"/>
  <rect x="310" y="248" width="100" height="18" rx="4" fill="rgba(238,9,121,0.2)" stroke="#ee0979" stroke-width="1"/>
  <text x="360" y="261" text-anchor="middle" fill="#ee0979" font-family="Arial, sans-serif" font-size="9">Token Inválido</text>
  
  <path d="M 275 290 L 105 290" stroke="#ee0979" stroke-width="2" marker-end="url(#arrow)"/>
  <rect x="140" y="268" width="90" height="18" rx="4" fill="rgba(238,9,121,0.2)" stroke="#ee0979" stroke-width="1"/>
  <text x="185" y="281" text-anchor="middle" fill="#ee0979" font-family="Arial, sans-serif" font-size="9" font-weight="bold">401</text>
  
  <!-- Token Valid path -->
  <path d="M 490 270 L 530 270 L 530 320 L 635 320" stroke="#38ef7d" stroke-width="2" marker-end="url(#arrow)"/>
  <rect x="530" y="305" width="100" height="22" rx="4" fill="#2d3748"/>
  <text x="580" y="320" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">SELECT user</text>
  
  <!-- Database returns user -->
  <path d="M 635 345 L 465 345" stroke="#00f2fe" stroke-width="2" marker-end="url(#arrow)"/>
  <rect x="500" y="330" width="80" height="22" rx="4" fill="#2d3748"/>
  <text x="540" y="345" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9">User data</text>
  
  <!-- Check if user is active -->
  <polygon points="460,370 490,390 460,410 430,390" fill="#2d3748" stroke="#fee140" stroke-width="2"/>
  <text x="460" y="393" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="7">Ativo?</text>
  
  <!-- User inactive -->
  <path d="M 430 390 L 285 390" stroke="#ee0979" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="360" y="385" text-anchor="middle" fill="#ee0979" font-family="Arial, sans-serif" font-size="8">Inativo</text>
  
  <!-- User active - success -->
  <path d="M 490 390 L 530 390 L 530 420 L 285 420" stroke="#38ef7d" stroke-width="2" marker-end="url(#arrow)"/>
  <rect x="340" y="398" width="80" height="18" rx="4" fill="rgba(56,239,125,0.2)" stroke="#38ef7d" stroke-width="1"/>
  <text x="380" y="411" text-anchor="middle" fill="#38ef7d" font-family="Arial, sans-serif" font-size="9">User Object</text>
  
  <!-- Success to Client -->
  <path d="M 275 420 L 105 420" stroke="#38ef7d" stroke-width="2" marker-end="url(#arrow)"/>
  <rect x="140" y="398" width="90" height="18" rx="4" fill="rgba(56,239,125,0.2)" stroke="#38ef7d" stroke-width="1"/>
  <text x="185" y="411" text-anchor="middle" fill="#38ef7d" font-family="Arial, sans-serif" font-size="9" font-weight="bold">✓ Autorizado</text>
  
  <!-- Legend -->
  <rect x="700" y="120" width="90" height="80" rx="6" fill="rgba(255,255,255,0.05)"/>
  <text x="745" y="140" text-anchor="middle" fill="#fff" font-family="Arial, sans-serif" font-size="9" font-weight="bold">Legenda</text>
  <line x1="710" y1="155" x2="740" y2="155" stroke="#38ef7d" stroke-width="2"/>
  <text x="755" y="158" fill="#a0aec0" font-family="Arial, sans-serif" font-size="8">Sucesso</text>
  <line x1="710" y1="175" x2="740" y2="175" stroke="#ee0979" stroke-width="2"/>
  <text x="755" y="178" fill="#a0aec0" font-family="Arial, sans-serif" font-size="8">Erro</text>
</svg>